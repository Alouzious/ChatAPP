{% extends 'chat/base.html' %}
{% load static %}

{% block title %}Registered Users | MyWeChat{% endblock %}



{% block content %}
<div class="registered_users" id="registered">
    <div class="registered_header">
        <h1>People You Can Connect With</h1>
    </div>
    <p>Logged in as: {{ request.user.username }} | Users found: {{ users|length }}</p>
    <p>Click "Connect" to send a connection request to any user.</p>
    
    {% if request.user.is_authenticated %}
        <p>Welcome, {{ request.user.username }}!</p>
    {% else %}
        <p>Please log in to connect with users.</p>
    {% endif %}
    <div class="registered_list">
        {% for user in users %}
            <div class="registered_user">
                <div class="user_avatar">
                    <!-- Show first letter of username in uppercase -->
                    <div class="default_avatar">{{ user.username|slice:":1"|upper }}</div>
                    <div class="username">{{ user.username }}</div>
                </div>
                <div class="user_status">
                    {% if user.is_active %}
                        <span class="status active">Active</span>
                    {% else %}
                        <span class="status inactive">Inactive</span>
                    {% endif %}
                </div>
                <div class="user_connect">
                    <form action="{% url 'send_request' user.id %}" method="post">
                        {% csrf_token %}
                        <button type="submit" class="connect_button" onclick="return confirm('Are you sure you want to connect with this user?');">
                            Connect
                        </button>
                    </form>
                </div>
            </div>
        {% empty %}
            <p>No registered users yet.</p>
        {% endfor %}
    </div>
</div>
{% endblock %}
